# Windows系统工具箱

一个功能强大的Windows系统工具箱，提供右键菜单切换和DNS缓存清理等实用功能。

## 功能特性

- ✅ 友好的图形用户界面（GUI）
- ✅ 支持Windows 10和Windows 11右键菜单样式切换
- ✅ 实时显示当前右键菜单模式
- ✅ 自动检测并申请管理员权限
- ✅ 一键清理本地DNS缓存
- ✅ 一键重启文件资源管理器应用更改
- ✅ 切换完成后提示是否重启资源管理器
- ✅ 优化的界面布局，更美观易用

## 系统要求

- Windows 10 或 Windows 11
- Python 3.6 或更高版本
- 管理员权限

## 安装

1. 确保已安装Python 3.6或更高版本
2. 下载 `context_menu_switcher.py` 文件
3. 无需额外安装依赖，使用Python标准库

## 使用方法

### 直接运行

1. 双击 `context_menu_switcher.py` 文件
2. 或通过命令行运行：
   ```bash
   python context_menu_switcher.py
   ```

### 自动申请管理员权限

程序启动时会自动检测管理员权限：
- 如果未获得管理员权限，会弹出提示询问是否自动以管理员身份重新启动
- 选择"是"即可自动以管理员身份运行程序

## 使用说明

### 右键菜单切换

1. 启动程序后，界面会显示当前的右键菜单模式（Windows 10或Windows 11）
2. 在"右键菜单切换"区域选择您想要的右键菜单样式
3. 点击"应用更改"按钮
4. 程序会提示是否重启文件资源管理器，选择"是"以立即应用更改
5. 也可以随时点击"重启文件资源管理器"按钮手动重启

### 清理DNS缓存

1. 在"网络工具"区域点击"清理DNS缓存"按钮
2. 确认清理操作
3. 等待清理完成
4. 网络连接可能需要几秒钟恢复正常

### 权限信息

- 程序底部显示当前权限状态
- 绿色✓表示已获得管理员权限
- 红色✗表示未获得管理员权限

## 工作原理

### 右键菜单切换

该工具通过修改Windows注册表来切换右键菜单样式：

- **Windows 10样式**：在注册表中创建特定键值
- **Windows 11样式**：删除注册表中的特定键值

注册表路径：`HKEY_CURRENT_USER\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}`

### DNS缓存清理

该工具使用Windows内置的`ipconfig /flushdns`命令清理本地DNS缓存，这可以解决以下问题：
- 网站无法访问或加载缓慢
- DNS解析错误
- 网络连接不稳定

## 注意事项

- ⚠️ 程序需要管理员权限才能修改系统设置和清理DNS缓存
- ⚠️ 修改注册表后需要重启文件资源管理器才能生效
- ⚠️ 清理DNS缓存后，网络连接可能需要几秒钟恢复正常
- ⚠️ 建议在使用前备份注册表（虽然此工具只修改特定键值，风险较低）
- ⚠️ Windows 11默认使用新的右键菜单样式
- ⚠️ 清理DNS缓存是安全的操作，不会影响系统稳定性

## 常见问题

### Q: 为什么提示需要管理员权限？
A: 修改Windows注册表和清理DNS缓存都需要管理员权限，这是Windows的安全机制。

### Q: 如何自动获得管理员权限？
A: 程序启动时会自动检测权限，如果未获得管理员权限，会弹出提示询问是否自动以管理员身份重新启动。

### Q: 切换后右键菜单没有变化？
A: 需要重启文件资源管理器才能应用更改，程序会提示您是否自动重启。

### Q: 清理DNS缓存有什么用？
A: 清理DNS缓存可以解决网站无法访问、DNS解析错误、网络连接缓慢等问题。

### Q: 如何恢复默认设置？
A: 在程序中选择"Windows 11"模式并应用即可恢复Windows 11的默认右键菜单。

### Q: 这个工具安全吗？
A: 是的，该工具只修改特定的注册表键值和使用系统命令，不会影响系统其他功能。但建议在使用前备份注册表。

## 技术支持

如有问题或建议，请通过以下方式联系：
- 提交Issue
- 发送邮件

## 许可证

本项目采用MIT许可证。

## 更新日志

### v2.0.0 (2026-01-02)
- ✨ 新增自动申请管理员权限功能
- ✨ 新增清理本地DNS缓存功能
- 🎨 优化界面布局，提升用户体验
- 🎨 更新窗口标题为"Windows系统工具箱"
- 🎨 改进权限提示和状态显示
- 🗑️ 移除批处理启动文件，简化使用流程

### v1.0.0 (2026-01-02)
- 初始版本发布
- 支持Windows 10/11右键菜单切换
- 实现图形用户界面
- 添加管理员权限检测
- 添加文件资源管理器重启功能
